definition:
  openapi: 3.0.0
  info:
    title: Gyors éttermi rendszer API dokumentáció
    description: A /user/login tól kapott tokent kell be másolni az autentikációhoz
    version: 0.0.2
  servers:
    - url: https://mateszadam.koyeb.app/
    - url: http://localhost:5005/
  components:
    securitySchemes:
      adminBearerAuth:
        type: http
        scheme: bearer
        bearerFormat: JWT
        description: 'Enter your bearer token in the format **Bearer <token>**'
      customerBearerAuth:
        type: http
        scheme: bearer
        bearerFormat: JWT
        description: 'Enter your bearer token in the format **Bearer <token>**'
      kitchenBearerAuth:
        type: http
        scheme: bearer
        bearerFormat: JWT
        description: 'Enter your bearer token in the format **Bearer <token>**'
      salesmanBearerAuth:
        type: http
        scheme: bearer
        bearerFormat: JWT
        description: 'Enter your bearer token in the format **Bearer <token>**'
    parameters:
      AcceptLanguage:
        name: Accept-Language
        in: header
        default: hu
        description: Language preference for response (hu, en-GB)
        required: false
        schema:
          type: string
  security:
    - adminBearerAuth: []
    - customerBearerAuth: []
    - salesmanBearerAuth: []
    - kitchenBearerAuth: []
apis: [./src/swagger/swagger.yaml]

paths:
  # Category Paths
  /category:
    post:
      summary: Add a new category
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
      tags: [Category]
      security:
        - adminBearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Category'
      responses:
        '200':
          description: Category added successfully
        '400':
          description: Bad request
    get:
      summary: Filter categories
      tags: [Category]
      security:
        - adminBearerAuth: []
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
        - name: field
          in: query
          schema:
            type: string
          description: Field to filter by
        - name: value
          in: query
          schema:
            type: string
          description: Value to filter by
        - name: limit
          in: query
          schema:
            type: number
          description: Number of items per page
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer

      responses:
        '200':
          description: Categories retrieved successfully
        '400':
          description: Bad request
  /category/{id}:
    delete:
      summary: Delete a category
      tags: [Category]
      security:
        - adminBearerAuth: []
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Category deleted successfully
          $ref: '#/components/schemas/Category'
        '400':
          description: Bad request
    put:
      summary: Modify a category
      tags: [Category]
      security:
        - adminBearerAuth: []
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Category'
      responses:
        '200':
          description: Category modified successfully
          $ref: '#/components/schemas/Category'
        '400':
          description: Bad request

  # Food Paths
  /food:
    post:
      summary: Add a new food item
      tags: [Food]
      security:
        - adminBearerAuth: []
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Food'
      responses:
        '200':
          description: Food item added successfully
        '400':
          description: Bad request
    get:
      summary: Filter food items
      tags: [Food]
      security:
        - adminBearerAuth: []
        - customerBearerAuth: []

      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
        - in: query
          name: field
          schema:
            type: string
          description: Field to filter by
        - in: query
          name: value
          schema:
            type: string
          description: Value to filter by
        - in: query
          name: page
          schema:
            type: integer
          description: Page number
        - in: query
          name: limit
          schema:
            type: integer
          description: Number of items per page

      responses:
        '200':
          description: Filtered food items
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Food'
        '400':
          description: Bad request
  /food/allEnabled:
    get:
      summary: Get all enabled food items
      tags: [Food]
      security:
        - adminBearerAuth: []
        - customerBearerAuth: []
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
        - in: query
          name: page
          schema:
            type: integer
          description: Page number
        - in: query
          name: limit
          schema:
            type: integer
          description: Number of items per page
      responses:
        '200':
          description: List of enabled food items
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Food'
        '400':
          description: Bad request

  /food/{id}:
    put:
      summary: Update a food item
      tags: [Food]
      security:
        - adminBearerAuth: []
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Food item ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Food'
      responses:
        '200':
          description: Food item updated successfully
        '400':
          description: Bad request
    patch:
      summary: Update a food item
      tags: [Food]
      security:
        - adminBearerAuth: []

      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Food item ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Food'
      responses:
        '200':
          description: Food item updated successfully
        '400':
          description: Bad request
    delete:
      summary: Delete a food item
      tags: [Food]
      security:
        - adminBearerAuth: []
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'

        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Food item ID
      responses:
        '200':
          description: Food item deleted successfully
        '400':
          description: Bad request
  /food/disable/{id}:
    patch:
      summary: Disable a food item
      tags: [Food]
      security:
        - adminBearerAuth: []

      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'

        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Food item ID
      responses:
        '200':
          description: Food item disabled successfully
        '400':
          description: Bad request
  /food/enable/{id}:
    patch:
      summary: Enable a food item
      tags: [Food]
      security:
        - adminBearerAuth: []

      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'

        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Food item ID
      responses:
        '200':
          description: Food item enabled successfully
        '400':
          description: Bad request
# Image paths
/images/name/{imageName}:
  get:
    summary: Retrieve an image
    tags: [Images]
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: path
        name: imageName
        required: true
        schema:
          type: string
        description: The name of the image to retrieve
    responses:
      200:
        description: An image file.
        content:
          image/svg+xml:
            schema:
              type: string
              format: binary
      400:
        description: Bad request
/images:
  post:
    summary: Upload an image
    tags: [Images]
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    requestBody:
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              image:
                type: string
                format: binary
    responses:
      200:
        description: Image uploaded successfully
      400:
        description: Bad request
/images/all:
  get:
    summary: List all images
    tags: [Images]
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    responses:
      200:
        description: A list of all images
      400:
        description: Bad request
/images/profile:
  get:
    summary: List all profile pictures
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    tags: [Images]
    responses:
      200:
        description: A list of all profile pictures
      400:
        description: Bad request
/images/profile/{name}:
  get:
    summary: Get profile picture by name
    tags: [Images]
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: path
        name: name
        required: true
        schema:
          type: string
        description: The name of the profile picture to retrieve
    responses:
      200:
        description: A profile picture file.
        content:
          image/svg+xml:
            schema:
              type: string
              format: binary
      400:
        description: Bad request

# Inventory
/inventory:
  post:
    tags:
      - Inventory
    summary: Add a new material change
    security:
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/MaterialChange'
    responses:
      '200':
        description: Material change added successfully
      '400':
        description: Bad request
  get:
    tags:
      - Inventory
    summary: Get all material changes
    security:
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: field
        in: query
        description: Field to filter by
        required: false
        schema:
          type: string
      - name: value
        in: query
        description: Value to filter by
        required: false
        schema:
          type: string
      - name: page
        in: query
        description: Page number for pagination
        required: false
        schema:
          type: integer
      - name: limit
        in: query
        description: Items per page
        required: false
        schema:
          type: integer
    responses:
      '200':
        description: A list of material changes
      '400':
        description: Bad request
/inventory/{id}:
  patch:
    tags:
      - Inventory
    summary: Update a material change
    security:
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: id
        in: path
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/MaterialChange'
    responses:
      '200':
        description: Material change updated successfully
      '400':
        description: Bad request
  put:
    tags:
      - Inventory
    summary: Update a material change
    security:
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: id
        in: path
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/MaterialChange'
    responses:
      '200':
        description: Material change updated successfully
      '400':
        description: Bad request
  delete:
    tags:
      - Inventory
    summary: Delete a material change
    security:
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: id
        in: path
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Material change deleted successfully
      '400':
        description: Bad request
/inventory/changes:
  get:
    tags:
      - Inventory
    summary: Get paginated material changes
    security:
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: page
        in: query
        description: Page number for pagination
        required: false
        schema:
          type: integer
      - name: limit
        in: query
        description: Number of items per page
        required: false
        schema:
          type: integer
      - name: field
        in: query
        description: Field name for filtering
        required: false
        schema:
          type: string
      - name: value
        in: query
        description: Value to filter by
        required: false
        schema:
          type: string
    responses:
      '200':
        description: Paginated list of material changes
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/MaterialChange'
                pageCount:
                  type: integer
      '400':
        description: Bad request

  # Order
/order:
  post:
    summary: Create a new order
    tags: [Order]

    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Order'
    responses:
      '201':
        description: Order created successfully
      '400':
        description: Bad request
  get:
    summary: Get all orders by page
    tags: [Order]

    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: field
        in: query
        schema:
          type: string
      - name: value
        in: query
        schema:
          type: string
      - name: page
        in: query
        schema:
          type: integer
      - name: from
        in: query
        schema:
          type: string
      - name: to
        in: query
        schema:
          type: string
    responses:
      '200':
        description: List of orders
      '400':
        description: Bad request
/order/salesman:
  get:
    summary: Get all ongoing orders for salesman
    tags: [Order]
    security:
      - salesmanBearerAuth: []
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    responses:
      '200':
        description: List of ongoing orders
      '400':
        description: Bad request
/order/kitchen:
  get:
    summary: Get all orders for kitchen
    tags: [Order]

    security:
      - kitchenBearerAuth: []
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    responses:
      '200':
        description: List of orders for kitchen
      '400':
        description: Bad request
/order/display:
  get:
    summary: Get orders for display
    tags: [Order]
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    responses:
      '200':
        description: List of orders for display
      '400':
        description: Bad request
/order/finish/{id}:
  patch:
    summary: Mark order as finished by kitchen
    tags: [Order]

    security:
      - bearerAuth: []
      - kitchenBearerAuth: []

    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: id
        in: path
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Order marked as finished
      '400':
        description: Bad request
/order/handover/{id}:
  patch:
    summary: Mark order as received by salesman
    tags: [Order]

    security:
      - bearerAuth: []
      - salesmanBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: id
        in: path
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Order marked as received
      '400':
        description: Bad request
/order/revert/finish/{id}:
  patch:
    summary: Revert order finish by kitchen
    tags: [Order]

    security:
      - kitchenBearerAuth: []
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - name: id
        in: path
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Order finish reverted
      '400':
        description: Bad request
/order/revert/handover/{id}:
  patch:
    summary: Revert order received by salesman
    tags: [Order]

    security:
      - salesmanBearerAuth: []
      - adminBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'

      - name: id
        in: path
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Order received reverted
      '400':
        description: Bad request

# Token validation
/token/validate:
  get:
    summary: Validate token
    tags: [Token validation]
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    responses:
      200:
        description: Token is valid
      400:
        description: Token is invalid

/material:
  post:
    summary: Add a new material
    tags: [Material]
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Material'
    responses:
      '200':
        description: Material added successfully
      '400':
        description: Bad request
  get:
    summary: Get all materials
    tags: [Material]

    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: query
        name: field
        schema:
          type: string
      - in: query
        name: value
        schema:
          type: string
      - in: query
        name: page
        schema:
          type: integer
    responses:
      '200':
        description: List of materials
      '400':
        description: Bad request
/material/{id}:
  delete:
    summary: Delete a material by ID
    tags: [Material]

    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: path
        name: id
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Material deleted successfully
      '400':
        description: Bad request
  patch:
    summary: Update a material by ID
    tags: [Material]
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: path
        name: id
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Material'
    responses:
      '200':
        description: Material updated successfully
      '400':
        description: Bad request
  put:
    summary: Update a material by ID
    tags: [Material]

    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: path
        name: id
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Material'
    responses:
      '200':
        description: Material updated successfully
      '400':
        description: Bad request
# User handling
/user/all:
  get:
    tags: [User handling]
    security:
      - adminBearerAuth: []
    summary: Get all users
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    responses:
      201:
        description: User registered successfully
      400:
        description: Bad request
      401:
        description: Not authorized

/user/register/customer:
  post:
    tags: [User handling]
    summary: Register a new user
    security: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - name
              - password
              - email
            properties:
              name:
                type: string
                default: customerUser
              password:
                type: string
                default: customerUser!1
              email:
                type: string
                default: admin@gmail.hu
    responses:
      201:
        description: User registered successfully

/user/register/admin:
  post:
    tags: [User handling]
    summary: Register a new admin
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    security:
      - adminBearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - name
              - password
              - email
              - role
            properties:
              name:
                type: string
                default: adminUser
              password:
                type: string
                default: adminUser!1
              email:
                type: string
                default: admin@gmail.com
              role:
                type: string
                default: admin
    responses:
      201:
        description: Admin registered successfully
      400:
        description: Bad request

/user/delete/admin/{id}:
  delete:
    tags: [User handling]
    security:
      - adminBearerAuth: []
    summary: Delete users with admin roles (only admin can access)
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: path
        name: id
        required: true
        schema:
          type: string
        description: The id of the user
    responses:
      201:
        description: Deleted successfully
      400:
        description: Bad request

/user/delete/customer/{id}:
  delete:
    tags: [User handling]
    summary: Delete costumers.
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: path
        name: id
        required: true
        schema:
          type: string
        description: The id of the user
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    responses:
      201:
        description: Deleted successfully
      400:
        description: Bad request

/user/login:
  post:
    tags: [User handling]
    summary: Login a user
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    security: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - name
              - password
            properties:
              name:
                type: string
                default: admin
              password:
                type: string
                default: admin
    responses:
      200:
        description: User logged in successfully

/user/logout:
  post:
    tags: [User handling]
    summary: Logout a user
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
    security:
      - adminBearerAuth: []
    responses:
      200:
        description: User logged out successfully

/user/picture/change/{newImageName}:
  post:
    tags: [User handling]
    summary: Change profile picture
    security:
      - adminBearerAuth: []
      - customerBearerAuth: []
    parameters:
      - $ref: '#/components/parameters/AcceptLanguage'
      - in: path
        name: newImageName
        required: true
        schema:
          type: string
        description: The new image name for the profile picture
    responses:
      200:
        description: Profile picture changed successfully

components:
  schemas:
    Food:
      type: object
      required:
        - name
        - englishName
        - price
        - material

      properties:
        name:
          type: string
        price:
          type: number
        materials:
          type: array
          items:
            type: object
            properties:
              _id:
                type: string
              quantity:
                type: number
        isEnabled:
          type: boolean
          default: true
        categoryId:
          type: string
          default: 679f462818947c0fa463a88f
        subCategoryId:
          type: array
          items:
            type: string
            default: 679f462818947c0fa463a88f
        englishName:
          type: string
        image:
          type: string
          default: no-image.svg
    MaterialChange:
      type: object
      properties:
        materialId:
          type: string
        quantity:
          type: number
        message:
          type: string
      required:
        - materialId
        - quantity
        - message
    Material:
      type: object
      properties:
        name:
          type: string
        englishName:
          type: string
        unit:
          type: string
      required:
        - name
        - englishName
        - unit
    Category:
      type: object
      properties:
        name:
          type: string
        icon:
          type: string
        englishName:
          type: string
      required:
        - name
        - icon
        - englishName
    Order:
      type: object
      required:
        - costumerId
        - orderedProducts
      properties:
        costumerId:
          type: string
          default: 6793b122d55c7354ff36be8f
        orderedProducts:
          type: array
          items:
            type: object
            properties:
              _id:
                type: string
                default: 67a74ef1b660887ac98cc8f7
              quantity:
                type: integer
                default: 1
